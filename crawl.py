import requests
from bs4 import BeautifulSoup
import pandas as pd

vms = ['VMware','Qemu','VirtualBox','Parallels']
results = []

print("[+] Initialize")
for vm in vms:
    print("[+] "+vm+" Started")
    req = requests.get('https://cve.dropper.tech/search.php?searchData='+vm)

    html = req.text
    soup = BeautifulSoup(html, 'html.parser')

    titles = soup.select('body > div > div > div > div > h5 > strong')
    
    for title in titles:
        req_in = requests.get('https://dropper.me/viewer.php?searchCVE='+title.text)
        html_in = req_in.text
        
        soup_in = BeautifulSoup(html_in,'html.parser')

        #Add whatever you want
        title_in = soup_in.select('#binfo > div > table > tbody > tr:nth-child(1) > td.detail-info')
        vuln = soup_in.select('#binfo > div > table > tbody > tr:nth-child(2) > td.detail-info')
        vector = soup_in.select('#binfo > div > table > tbody > tr:nth-child(9) > td.detail-info')
        cvss = soup_in.select('#binfo > div > table > tbody > tr:nth-child(10) > td.detail-info')
        desc = soup_in.select('#binfo > div > table > tbody > tr:nth-child(11) > td.innertable.multiline')

        for t,v,v1,c,d in zip(title_in,vector,vuln,cvss,desc):
            results.append([vm,t.text[4:8],t.text,v.text,v1.text,c.text,d.text])
    print("[+] "+vm+" Finished")

data = pd.DataFrame(results)
data.to_csv('crawl_result.csv')
print("[+] End")
